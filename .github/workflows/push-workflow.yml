name: Push Workflow

on:
  push:
    branches:
    - main

jobs:
  aws_workflow:
    uses: ./.github/workflows/gcp-workflow.yml
    with:
      WORKING_DIRECTORY: "./aws"
    secrets: inherit
  gcp_workflow:
    needs: aws_workflow
    if: (needs.aws_workflow.result == 'success')
    uses: ./.github/workflows/gcp-workflow.yml
    with:
      WORKING_DIRECTORY: "./gcp"
    secrets: inherit
